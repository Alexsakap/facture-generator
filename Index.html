<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>G√©n√©rateur de Facture Artiste-Auteur</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #f5f5f7;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Zone d'√©dition - visible uniquement √† l'√©cran */
        .editor-panel {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .editor-panel h2 {
            color: #1d1d1f;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #1d1d1f;
            font-weight: 500;
            font-size: 15px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            -webkit-appearance: none;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .btn {
            background: #0071e3;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-right: 10px;
            margin-top: 10px;
        }

        .btn:active {
            background: #0077ed;
        }

        .btn-secondary {
            background: #f5f5f7;
            color: #1d1d1f;
        }

        /* Zone de pr√©visualisation de la facture - visible √† l'√©cran et √† l'impression */
        .invoice-preview {
            background: white;
            padding: 60px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 1000px;
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 40px;
            border-bottom: 2px solid #1d1d1f;
            padding-bottom: 20px;
        }

        .invoice-logo {
            max-width: 200px;
            max-height: 100px;
        }

        .invoice-title {
            text-align: right;
        }

        .invoice-title h1 {
            font-size: 32px;
            color: #1d1d1f;
            margin-bottom: 10px;
        }

        .invoice-number {
            font-size: 16px;
            color: #86868b;
        }

        .invoice-parties {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .party h3 {
            font-size: 12px;
            text-transform: uppercase;
            color: #86868b;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .party-details {
            font-size: 14px;
            line-height: 1.8;
            color: #1d1d1f;
        }

        .party-details strong {
            font-size: 16px;
            display: block;
            margin-bottom: 5px;
        }

        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .invoice-table thead {
            background: #f5f5f7;
        }

        .invoice-table th {
            padding: 15px;
            text-align: left;
            font-size: 12px;
            text-transform: uppercase;
            color: #1d1d1f;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .invoice-table td {
            padding: 20px 15px;
            border-bottom: 1px solid #f5f5f7;
            color: #1d1d1f;
            font-size: 14px;
        }

        .invoice-table th:last-child,
        .invoice-table td:last-child {
            text-align: right;
        }

        .invoice-totals {
            margin-left: auto;
            width: 400px;
            margin-top: 20px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            font-size: 14px;
        }

        .total-row.grand-total {
            border-top: 2px solid #1d1d1f;
            margin-top: 10px;
            padding-top: 15px;
            font-size: 18px;
            font-weight: 600;
        }

        .invoice-footer {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid #d2d2d7;
        }

        .footer-section {
            margin-bottom: 25px;
        }

        .footer-section h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #1d1d1f;
        }

        .footer-section p {
            font-size: 13px;
            line-height: 1.6;
            color: #6e6e73;
        }

        /* Styles pour l'impression et export PDF */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            /* Cacher compl√®tement la zone d'√©dition */
            .editor-panel,
            .btn,
            button,
            input[type="file"] {
                display: none !important;
                visibility: hidden !important;
                height: 0 !important;
                overflow: hidden !important;
            }

            .container {
                max-width: 100%;
            }

            .invoice-preview {
                box-shadow: none;
                border-radius: 0;
                padding: 40px;
                margin: 0;
            }

            @page {
                margin: 1cm;
                size: A4;
            }
        }

        .logo-upload {
            margin-top: 10px;
        }

        #logoPreview {
            max-width: 200px;
            max-height: 100px;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ZONE D'√âDITION (cach√©e √† l'impression) -->
        <div class="editor-panel">
            <h2>üìù G√©n√©rateur de Facture Artiste-Auteur</h2>

            <div class="form-group">
                <label>Logo (optionnel)</label>
                <input type="file" id="logoInput" accept="image/*" class="logo-upload">
                <img id="logoPreview" alt="Logo">
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px;">Client</h3>
            <div class="form-group">
                <label>Nom du client *</label>
                <input type="text" id="clientName" value="CEVENNES STRUCTURES INGENIERIE" placeholder="Nom complet">
            </div>

            <div class="form-group">
                <label>Contact client</label>
                <input type="text" id="clientContact" value="Monsieur S√©bastien VOINDROT" placeholder="Nom du contact">
            </div>

            <div class="form-group">
                <label>Adresse client *</label>
                <textarea id="clientAddress" placeholder="Adresse compl√®te">400 Chemin DU PETIT DEVOIS
30520 SAINT-MARTIN-DE-VALGALGUES</textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>T√©l√©phone client</label>
                    <input type="tel" id="clientPhone" value="+33 6 60 88 83 79" placeholder="+33 X XX XX XX XX">
                </div>
                <div class="form-group">
                    <label>Email client</label>
                    <input type="email" id="clientEmail" value="svoindrot@gmail.com" placeholder="email@example.com">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>SIRET client</label>
                    <input type="text" id="clientSiret" value="79475387100019" placeholder="XXXXXXXXXXXXXXXXX">
                </div>
                <div class="form-group">
                    <label>N¬∞ TVA client</label>
                    <input type="text" id="clientTva" value="FR 73 794753871" placeholder="FR XX XXXXXXXXX">
                </div>
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px;">Facture</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>Num√©ro de facture *</label>
                    <input type="text" id="invoiceNumber" value="I-25-12-5" placeholder="Ex: I-25-12-5">
                </div>
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="invoiceDate" value="2025-12-28">
                </div>
            </div>

            <div class="form-group">
                <label>Statut</label>
                <select id="invoiceStatus">
                    <option value="PROVISOIRE" selected>PROVISOIRE</option>
                    <option value="D√âFINITIVE">D√âFINITIVE</option>
                    <option value="AVOIR">AVOIR</option>
                </select>
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px;">Prestation</h3>
            <div class="form-group">
                <label>R√©f√©rence</label>
                <input type="text" id="itemRef" value="I-25" placeholder="Ex: I-25">
            </div>

            <div class="form-group">
                <label>Description de la prestation *</label>
                <textarea id="itemDesc" placeholder="Description d√©taill√©e">Cr√©ation d'une ≈ìuvre num√©rique : Mod√©lisation 3D d'un ensemble r√©sidentiel</textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Quantit√©</label>
                    <input type="number" id="itemQty" value="1" step="0.01" min="0">
                </div>
                <div class="form-group">
                    <label>Prix unitaire HT (‚Ç¨)</label>
                    <input type="number" id="itemPrice" value="1110" step="0.01" min="0">
                </div>
            </div>

            <button class="btn" onclick="updatePreview()">üîÑ Actualiser l'aper√ßu</button>
            <button class="btn" onclick="window.print()">üñ®Ô∏è Exporter en PDF</button>
            <button class="btn btn-secondary" onclick="saveData()">üíæ Sauvegarder les donn√©es</button>
        </div>

        <!-- ZONE DE PR√âVISUALISATION (imprim√©e en PDF) -->
        <div class="invoice-preview" id="invoicePreview">
            <div class="invoice-header">
                <div>
                    <img id="invoiceLogo" class="invoice-logo" style="display: none;" alt="Logo">
                </div>
                <div class="invoice-title">
                    <h1>FACTURE</h1>
                    <div class="invoice-number" id="displayInvoiceNumber">N¬∞ I-25-12-5 (PROVISOIRE)</div>
                    <div class="invoice-number" id="displayInvoiceDate">Le 28 d√©cembre 2025</div>
                </div>
            </div>

            <div class="invoice-parties">
                <div class="party">
                    <h3>De</h3>
                    <div class="party-details">
                        <strong>OLEKSANDRA SPEZIALE</strong>
                        1 rue Edouard Herriot<br>
                        30520 SAINT-MARTIN-DE-VALGALGUES<br>
                        FRANCE<br>
                        <br>
                        Port.: +33 6 46 05 08 98<br>
                        alexsa.kap@gmail.com<br>
                        <br>
                        N¬∞ SIRET: 99369502200018<br>
                        Code NAF: 90.03A
                    </div>
                </div>

                <div class="party">
                    <h3>√Ä</h3>
                    <div class="party-details" id="clientInfo">
                        <strong>CEVENNES STRUCTURES INGENIERIE</strong>
                        Monsieur S√©bastien VOINDROT<br>
                        400 Chemin DU PETIT DEVOIS<br>
                        30520 SAINT-MARTIN-DE-VALGALGUES<br>
                        <br>
                        Port.: +33 6 60 88 83 79<br>
                        svoindrot@gmail.com<br>
                        <br>
                        N¬∞ TVA: FR 73 794753871<br>
                        SIRET: 79475387100019
                    </div>
                </div>
            </div>

            <table class="invoice-table">
                <thead>
                    <tr>
                        <th>R√©f√©rence</th>
                        <th>D√©signation</th>
                        <th>Quantit√©</th>
                        <th>PU HT</th>
                        <th>Montant HT</th>
                    </tr>
                </thead>
                <tbody id="invoiceItems">
                    <tr>
                        <td>I-25</td>
                        <td>Cr√©ation d'une ≈ìuvre num√©rique : Mod√©lisation 3D d'un ensemble r√©sidentiel</td>
                        <td>1,00</td>
                        <td>1 110,00 ‚Ç¨</td>
                        <td>1 110,00 ‚Ç¨</td>
                    </tr>
                </tbody>
            </table>

            <div class="invoice-totals">
                <div class="total-row">
                    <span>Total HT</span>
                    <span id="totalHT">1 110,00 ‚Ç¨</span>
                </div>
                <div class="total-row">
                    <span>TVA (0%)</span>
                    <span>0,00 ‚Ç¨</span>
                </div>
                <div class="total-row grand-total">
                    <span>Total TTC</span>
                    <span id="totalTTC">1 110,00 ‚Ç¨</span>
                </div>
            </div>

            <div class="invoice-footer">
                <div class="footer-section">
                    <h4>Conditions de paiement</h4>
                    <p>√Ä payer par virement bancaire.</p>
                </div>

                <div class="footer-section">
                    <h4>Mentions l√©gales</h4>
                    <p>
                        TVA non applicable, article 293 B du CGI.<br>
                        Artiste-auteur en dispense de pr√©compte (certificat d'immatriculation URSSAF fourni).
                    </p>
                </div>

                <div class="footer-section">
                    <h4>Coordonn√©es bancaires</h4>
                    <p>
                        Nickel<br>
                        BIC/SWIFT: FPELFR21XXX
                    </p>
                </div>

                <div class="footer-section">
                    <p style="font-size: 11px; color: #86868b;">
                        P√©nalit√© de retard : 3 fois le taux d'int√©r√™t l√©gal apr√®s la date d'√©ch√©ance.<br>
                        Indemnit√© forfaitaire pour frais de recouvrement : 40‚Ç¨ (article L441-6 du Code de commerce).
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Gestion du logo
        document.getElementById('logoInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('logoPreview').src = e.target.result;
                    document.getElementById('logoPreview').style.display = 'block';
                    document.getElementById('invoiceLogo').src = e.target.result;
                    document.getElementById('invoiceLogo').style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });

        // Mise √† jour de l'aper√ßu
        function updatePreview() {
            const clientName = document.getElementById('clientName').value;
            const clientContact = document.getElementById('clientContact').value;
            const clientAddress = document.getElementById('clientAddress').value.replace(/
/g, '<br>');
            const clientPhone = document.getElementById('clientPhone').value;
            const clientEmail = document.getElementById('clientEmail').value;
            const clientSiret = document.getElementById('clientSiret').value;
            const clientTva = document.getElementById('clientTva').value;

            const invoiceNumber = document.getElementById('invoiceNumber').value;
            const invoiceStatus = document.getElementById('invoiceStatus').value;
            const invoiceDate = document.getElementById('invoiceDate').value;

            const itemRef = document.getElementById('itemRef').value;
            const itemDesc = document.getElementById('itemDesc').value;
            const itemQty = parseFloat(document.getElementById('itemQty').value) || 0;
            const itemPrice = parseFloat(document.getElementById('itemPrice').value) || 0;

            // Mise √† jour des informations client
            let clientInfo = '';
            if (clientName) clientInfo += `<strong>${clientName}</strong><br>`;
            if (clientContact) clientInfo += `${clientContact}<br>`;
            if (clientAddress) clientInfo += `${clientAddress}<br><br>`;
            if (clientPhone) clientInfo += `Port.: ${clientPhone}<br>`;
            if (clientEmail) clientInfo += `${clientEmail}<br>`;
            if (clientSiret || clientTva) clientInfo += '<br>';
            if (clientTva) clientInfo += `N¬∞ TVA: ${clientTva}<br>`;
            if (clientSiret) clientInfo += `SIRET: ${clientSiret}`;

            document.getElementById('clientInfo').innerHTML = clientInfo;

            // Mise √† jour du num√©ro et de la date
            document.getElementById('displayInvoiceNumber').textContent = `N¬∞ ${invoiceNumber} (${invoiceStatus})`;

            const date = new Date(invoiceDate);
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateStr = date.toLocaleDateString('fr-FR', options);
            document.getElementById('displayInvoiceDate').textContent = `Le ${dateStr}`;

            // Mise √† jour des articles
            const totalHT = itemQty * itemPrice;
            const itemRow = `
                <tr>
                    <td>${itemRef}</td>
                    <td>${itemDesc}</td>
                    <td>${itemQty.toFixed(2)}</td>
                    <td>${itemPrice.toFixed(2).replace('.', ',')} ‚Ç¨</td>
                    <td>${totalHT.toFixed(2).replace('.', ',')} ‚Ç¨</td>
                </tr>
            `;
            document.getElementById('invoiceItems').innerHTML = itemRow;

            // Mise √† jour des totaux
            document.getElementById('totalHT').textContent = `${totalHT.toFixed(2).replace('.', ',')} ‚Ç¨`;
            document.getElementById('totalTTC').textContent = `${totalHT.toFixed(2).replace('.', ',')} ‚Ç¨`;

            alert('‚úÖ Aper√ßu actualis√© !');
        }

        // Sauvegarder les donn√©es dans localStorage
        function saveData() {
            const data = {
                clientName: document.getElementById('clientName').value,
                clientContact: document.getElementById('clientContact').value,
                clientAddress: document.getElementById('clientAddress').value,
                clientPhone: document.getElementById('clientPhone').value,
                clientEmail: document.getElementById('clientEmail').value,
                clientSiret: document.getElementById('clientSiret').value,
                clientTva: document.getElementById('clientTva').value,
                invoiceNumber: document.getElementById('invoiceNumber').value,
                invoiceStatus: document.getElementById('invoiceStatus').value,
                invoiceDate: document.getElementById('invoiceDate').value,
                itemRef: document.getElementById('itemRef').value,
                itemDesc: document.getElementById('itemDesc').value,
                itemQty: document.getElementById('itemQty').value,
                itemPrice: document.getElementById('itemPrice').value
            };

            localStorage.setItem('invoiceData', JSON.stringify(data));
            alert('üíæ Donn√©es sauvegard√©es !');
        }

        // Charger les donn√©es sauvegard√©es au d√©marrage
        window.addEventListener('load', function() {
            const savedData = localStorage.getItem('invoiceData');
            if (savedData) {
                const data = JSON.parse(savedData);
                Object.keys(data).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) element.value = data[key];
                });
            }
        });
    </script>
</body>
</html>
